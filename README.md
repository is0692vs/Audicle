# Auticle artykuł

![icon](auticle/images/icon128.png)

Auticle（アーティクル）は、ウェブページ上の記事コンテンツを音声で読み上げる Chrome 拡張機能です。クリックした段落から、記事の最後までをインテリジェントに読み上げ、再生箇所をハイライトすることで、快適な「ながら読書」体験を提供します。

## ✨ 主な機能

- **ワンクリック再生**: 記事の読みたい段落をクリックするだけで、そこから再生が開始されます。
- **インテリジェントな本文抽出**: [Mozilla Readability.js](https://github.com/mozilla/readability) を活用し、広告やサイドバーなどの不要な要素を除去。本文だけを賢く抽出します。
- **構造を意識した読み上げ**: 見出しや箇条書きを認識し、「見出し。」「箇条書きです。」といった前置きを付加することで、音声だけでも文章の構造を理解しやすくします。
- **連続再生 & プリフェッチ**: 記事の最後まで音声を自動で連続再生。次に再生する音声データを先読み（プリフェッチ）することで、チャンク間の途切れを最小限に抑えます。
- **同期ハイライト**: 現在再生中の段落がリアルタイムでハイライトされ、どこを読んでいるかが一目でわかります。
- **再生コントロール**: ポップアップから、読み上げモードの ON/OFF や、再生の一時停止/再開が可能です。

## 📖 使い方

1.  **インストール**: `chrome://extensions` ページで「パッケージ化されていない拡張機能を読み込む」を選択し、`auticle`ディレクトリを読み込みます。
2.  **有効化**: 読み上げたい記事ページを開き、ブラウザのツールバーにある Auticle アイコンをクリック。ポップアップ内の「読み上げモード」トグルスイッチを ON にします。
3.  **再生**: ページ上のハイライト可能になった段落をクリックすると、その位置から 2.0 倍速での読み上げが開始されます。
4.  **操作**:
    - **再生位置の変更**: 別の段落をクリックすると、再生が即座にその位置へ移動します。
    - **一時停止/再開**: ポップアップの「一時停止」ボタンで再生を止め、「再開」ボタンで続きから再生できます。
    - **完全停止**: 「読み上げモード」のトグルスイッチを OFF にすると、再生が完全に停止し、ハイライトも解除されます。

## 🛠️ アーキテクチャ概要

本拡張機能は、責務を明確に分離したコンポーネントで構成されています。

- **`popup.html` / `popup.js` / `popup.css`**: ユーザーが操作する UI を提供。拡張機能の ON/OFF、一時停止/再開の**意思**を`chrome.storage`やメッセージを通じて`content.js`に伝えます。
- **`content.js`**: ページ上で動作するメインスクリプト。
  - `Readability.js`を使い、本文の構造化されたテキストを抽出。
  - 再生キューの管理、連続再生、同期ハイライトの全ロジックを担当。
  - `background.js`にテキストを渡し、音声データの取得を依頼します。
- **`background.js`**: バックグラウンドで動作するサービスワーカー。
  - `content.js`から受け取ったテキストを元に、Google 翻訳の TTS エンドポイントへ`fetch`リクエストを送信。
  - 取得した音声データ（MP3）を再生可能な`data: URL`に変換し、`content.js`に返却します。
- **`lib/Readability.js`**: Mozilla 製の本文抽出ライブラリ。ノイズを除去し、質の高いテキストコンテンツを提供します。

## 📂 ディレクトリ構造
